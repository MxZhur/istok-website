# Сайт "ИстоК" (Исторический Клуб)

## Информация для разработчиков

Сайт сделан на следующем технологическом стеке:

- Laravel 11
- Vue.js 3 + Inertia
- MySQL

### Инициализация

1. Убедитесь, что в системе установлен Docker и Docker Compose.

2. Скопируйте файлы `.env.example` в `.env` в корне репозитория и в папке `src`.

3. Настройте подключение к базе данных — задайте имя пользователя БД и пароль в _обоих_ `.env`-файлах. Также необходимо будет изменить некоторые другие переменные типа `APP_URL` по мере необходимости.

4. В терминале зайдите в корневую папку репозитория и запустите контейнеры:

    ```bash
    docker compose up -d
    ```

5. Зайдите в PHP-контейнер (не контейнер сервера и не контейнер PhpMyAdmin) и установите PHP-зависимости:

    ```bash
    docker exec -it ИМЯ_ИЛИ_ID_КОНТЕЙНЕРА bash
    composer install # или composer update
    ```

6. В этом же контейнере сгенерируйте ключ Laravel-приложения:

    ```bash
    php artisan key:generate
    ```

7. В этом же контейнере создайте учётную запись администратора (не забудьте поменять ему E-mail и пароль в профиле, когда приложение запустится):

    ```bash
    php artisan admin:create
    ```

8. Зайдите в NPM-контейнер и установите JS-зависимости:

    ```bash
    docker exec -it ИМЯ_ИЛИ_ID_КОНТЕЙНЕРА bash
    npm install
    ```

9. В этом же контейнере сделайте сборку фронтенда:

    ```bash
    npm run build
    ```

    В рамках разработки вместо `npm run build` запускается команда `npm run dev`, а терминал с процессом этой команды должен оставаться открытым.

### Замечания

1. По какой-то причине Vite HMR ("горячая перезагрузка") не работает должным образом через Docker. Для того, чтобы изменения на фронтенде во время разработки всё-таки применялись, необходимо перезапускать Vite-сервер вручную каждый раз после внесения изменений. Для этого нужно в терминале Vite ввести `r` и нажать `Enter`. При этом, если в браузере открыта страница проекта, она автоматически перезагрузится (по крайней мере, в Mozilla Firefox есть такое поведение).
